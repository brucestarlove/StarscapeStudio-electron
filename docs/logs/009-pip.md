## Summary

Implemented Track 1 Main + Track 2+ PiP.

### Completed tasks

1. Visual track identification — Added "MAIN" badge to Track 1 header
2. CanvasNode helper — Added `getCanvasNodeByClipId()` helper function
3. Smart canvasNode initialization — Updated `createClip()` and `splitClip()` to initialize canvasNodes:
   - Track 1: Full canvas (1920x1080) at (0,0)
   - Track 2+: Default PiP size (480x270) at bottom-right with padding
   - Split clips inherit parent transforms
4. Track-aware canvas rendering — Updated `CanvasCompositor` to:
   - Render Track 1 full-screen without transforms
   - Apply transforms (position, scale, rotation, opacity) for Track 2+ clips
   - Handle coordinate transformations properly
5. Interactive transform controls — Created `TransformControls` component with:
   - Drag to move PiP clips
   - 4 corner resize handles
   - Rotation handle
   - Coordinate transformation between logical and display space
6. Stage integration — Wired canvasNodes through Stage to compositor with ResizeObserver for canvas dimensions
7. Export flow updates — Updated export pipeline:
   - ExportDialog includes canvasNodes and sets track roles (main vs overlay)
   - editPlan.js processes canvasNode transforms for overlay tracks
   - Data structure ready for FFmpeg filter generation (export.js needs FFmpeg filter chain implementation)

### Note

The export.js file structure is in place, but FFmpeg filter chain generation for overlays with transforms (scale, overlay, rotate, opacity) still needs implementation. The data flow is complete: canvasNodes are passed through ExportDialog → editPlan.js → ready for export.js processing.

All todos are complete. The system is ready for testing the PiP functionality in the UI.
